<!-- æ–‡ç« å†…å®¹å¸ƒå±€é¡µ -->
<!DOCTYPE html>
<html lang="en">
  <!-- head.htmlå­˜æ”¾é¡µé¢é€šç”¨çš„å…ƒæ•°æ®ã€cssã€jsç­‰é“¾æ¥èµ„æº -->
<head>
  <meta name="generator" content="Hugo 0.79.1" />
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>MySQL INSERT IGNORE INTO | Luyik754081's blog</title>
  <meta name="description" content="Loji44&#39;s Blog. Focus on Java, Linux, Golang, Git, Vim, Docker, etc." />
  <meta name="viewport" content="width=device-width" />
  <link href="/favicon.png" rel="icon" />
  <link rel="stylesheet" href="/static/css/github.css" />
  <link rel="stylesheet" href="/static/css/style.css" />
  <link rel="stylesheet" href="/static/css/search.css" />

  <script src="//cdn.staticfile.org/jquery/1.11.3/jquery.min.js"></script>
  <script type="text/javascript" src="/static/js/is.min.js"></script>
  <script type="text/javascript" src="/static/js/main.js"></script>
  <script type="text/javascript" src="/static/js/search.js" defer="true"></script>
</head>
  <body>
    <div id="container">
      <!-- å…¨å±€é¡¶éƒ¨å¯¼èˆªæ  -->
<div class="header">
  <span class="title"><a href="/">Luyik754081's blog</a></span>
  
    
    
    &#47;&nbsp;<a class="extra" href="/about.html">About</a>
  
    
    
    &#47;&nbsp;<a class="extra" href="/tags.html">TAGS</a>
  
    
    
    &#47;&nbsp;<a class="extra" href="/search.html">ğŸ”SEARCH</a>
  
</div>
      <div class="site">
        <!-- postæ–‡ç« çš„æ ‡é¢˜éƒ¨åˆ† -->
<div id="page_header">
  <div id="page_title">
    <h1>MySQL INSERT IGNORE INTO</h1>
  </div>
  <div id="page_meta">
    <span class="page_meta_tags">
      &#91;&nbsp;
      
        <!-- '/'å’Œç©ºæ ¼è½¬æ¢æˆ'-'ã€tagè‹±æ–‡è½¬æ¢æˆå°å†™å­—æ¯ -->
        
        <a class="extra" href="/tags/mysql.html">#MySQL</a>
      
      &nbsp;&#93;
    </span>
    <span class="page_meta_date">
        &#91;&nbsp;30 May 2020&nbsp;&#93;
    </span>
  </div>
</div>

        <div class="post">
          <p>å¼€å‘ä¸­ç»å¸¸ä¼šä¸€æ¬¡æ€§å¾€ä¸€ä¸ªé‡ŒINSERTå¤šæ¡æ•°æ®ï¼Œä½†æ˜¯å½“æŸæ¡INSERT SQLå› ä¸ºä¸è¡¨ä¸­å‘ç”Ÿ<strong>ä¸»é”®å†²çª</strong>ï¼Œæˆ–è€…ä¸æŸä¸ªå®šä¹‰ä¸º<code class="language-plaintext highlighter-rouge">UNIQUE KEY</code>çš„å­—æ®µå‘ç”Ÿ<code class="language-plaintext highlighter-rouge">Duplicate entry</code>é”™è¯¯æ—¶ï¼ŒMySQLä¼šæ”¾å¼ƒæ‰§è¡Œåç»­çš„INSERT SQLã€‚è€Œæˆ‘ä»¬å¸Œæœ›å¦‚æœæŸæ¡INSERTå‘ç”Ÿäº†å”¯ä¸€æ€§çº¦æŸçš„é”™è¯¯ï¼Œé‚£ä¹ˆè¿™æ¡INSERTä¸æ’å…¥æ•°æ®å³å¯ï¼Œä¸è¦å½±å“åé¢çš„å…¶ä»–INSERTè¯­å¥çš„æ‰§è¡Œã€‚</p>

<h3 id="1-éœ€æ±‚æè¿°">1. éœ€æ±‚æè¿°</h3>

<p>æœ‰å¼ è¡¨çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">`my_user`</span> <span class="p">(</span>
  <span class="nv">`id`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="nb">unsigned</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">COMMENT</span> <span class="s1">'è‡ªå¢ID'</span><span class="p">,</span>
  <span class="nv">`nickname`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'ç”¨æˆ·æ˜µç§°'</span><span class="p">,</span>
  <span class="nv">`mobile`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'æ‰‹æœºå·ç '</span><span class="p">,</span>
  <span class="nv">`email`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'é‚®ç®±åœ°å€'</span><span class="p">,</span>
  <span class="nv">`address`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'å±…ä½åœ°å€'</span><span class="p">,</span>
  <span class="nv">`age`</span> <span class="nb">tinyint</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="nb">unsigned</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'ç”¨æˆ·å¹´é¾„'</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">),</span>
  <span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="nv">`uk_nickname`</span> <span class="p">(</span><span class="nv">`nickname`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span> <span class="k">COMMENT</span><span class="o">=</span><span class="s1">'ç”¨æˆ·è¡¨'</span><span class="p">;</span>
</code></pre></div></div>

<blockquote>
  <p>idå­—æ®µä¸ºä¸»é”®ï¼›åœ¨nicknameå­—æ®µå¤„åˆ›å»ºäº†å”¯ä¸€ç´¢å¼•ã€‚</p>
</blockquote>

<p>å½“å¾€è¡¨é‡Œä¸€æ¬¡æ€§æ’å…¥å¤šæ¡æ•°æ®ï¼Œå‰ä¸¤æ¡æ•°æ®æ•°æ®çš„idå€¼éƒ½ä¸º1ï¼š</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'zhangsan'</span><span class="p">,</span> <span class="s1">'17777778901'</span><span class="p">,</span> <span class="s1">'zhangsan@foxmail.com'</span><span class="p">,</span> <span class="s1">'Beijing'</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'lisi'</span><span class="p">,</span> <span class="s1">'16688990101'</span><span class="p">,</span> <span class="s1">'lisi@foxmail.com'</span><span class="p">,</span> <span class="s1">'Hangzhou'</span><span class="p">,</span> <span class="mi">28</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">'wangwu'</span><span class="p">,</span> <span class="s1">'155784983939'</span><span class="p">,</span> <span class="s1">'wangwu@foxmail.com'</span><span class="p">,</span> <span class="s1">'Guangxi'</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</code></pre></div></div>

<p>ä¼šå‡ºç°ä¸»é”®å†²çªé”™è¯¯ï¼š</p>

<blockquote>
  <p>ERROR 1062 (23000): Duplicate entry â€˜1â€™ for key â€˜PRIMARYâ€™</p>
</blockquote>

<p>åŒæ ·ï¼Œå¾€è¡¨é‡Œä¸€æ¬¡æ€§æ’å…¥å¤šæ¡æ•°æ®ï¼Œå‰é¢ä¸¤æ¡æ•°æ®çš„nicknameéƒ½ä¸º<code class="language-plaintext highlighter-rouge">zhangsan</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œnicknameå­—æ®µæ˜¯æœ‰å”¯ä¸€ç´¢å¼•çº¦æŸçš„ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'zhangsan'</span><span class="p">,</span> <span class="s1">'17777778901'</span><span class="p">,</span> <span class="s1">'zhangsan@foxmail.com'</span><span class="p">,</span> <span class="s1">'Beijing'</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'zhangsan'</span><span class="p">,</span> <span class="s1">'16688990101'</span><span class="p">,</span> <span class="s1">'lisi@foxmail.com'</span><span class="p">,</span> <span class="s1">'Hangzhou'</span><span class="p">,</span> <span class="mi">28</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'wangwu'</span><span class="p">,</span> <span class="s1">'155784983939'</span><span class="p">,</span> <span class="s1">'wangwu@foxmail.com'</span><span class="p">,</span> <span class="s1">'Guangxi'</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</code></pre></div></div>

<p>åŒæ ·ä¹Ÿä¼šå‡ºç°å”¯ä¸€æ€§çº¦æŸé”™è¯¯ï¼š</p>

<blockquote>
  <p>ERROR 1062 (23000): Duplicate entry â€˜zhangsanâ€™ for key â€˜uk_usernameâ€™</p>
</blockquote>

<p>ä»¥ä¸Šä¸¤ç§å‡ºç°å”¯ä¸€æ€§çº¦æŸé”™è¯¯ä¹‹åï¼ŒMySQLå°±ä¸ä¼šæ‰§è¡Œåç»­çš„INSERT SQLï¼Œä¾‹å¦‚ä¸Šé¢çš„<code class="language-plaintext highlighter-rouge">wangwu</code>å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚åœ¨æ‰¹é‡æ‰§è¡ŒINSERT SQLæ—¶ï¼Œå¦‚ä½•å¿½ç•¥æŸäº›INSERTæ“ä½œå‘ç”Ÿçš„å”¯ä¸€æ€§çº¦æŸå¼‚å¸¸ï¼Œè€Œä¸å½±å“åç»­çš„INSERT SQLçš„æ‰§è¡Œå‘¢ï¼Ÿè¿™é‡Œè®°å½•ä¸¤ç§å®ç°æ–¹å¼ã€‚</p>

<h3 id="2-ä½¿ç”¨insert-ignore-into">2. ä½¿ç”¨<code class="language-plaintext highlighter-rouge">INSERT IGNORE INTO</code></h3>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">IGNORE</code>å­å¥æ˜¯MySQLå¯¹SQLæ ‡å‡†çš„æ‰©å±•ã€‚</p>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">IGNORE</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'zhangsan'</span><span class="p">,</span> <span class="s1">'17777778901'</span><span class="p">,</span> <span class="s1">'zhangsan@foxmail.com'</span><span class="p">,</span> <span class="s1">'Beijing'</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">IGNORE</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'zhangsan'</span><span class="p">,</span> <span class="s1">'16688990101'</span><span class="p">,</span> <span class="s1">'lisi@foxmail.com'</span><span class="p">,</span> <span class="s1">'Hangzhou'</span><span class="p">,</span> <span class="mi">28</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">IGNORE</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'wangwu'</span><span class="p">,</span> <span class="s1">'155784983939'</span><span class="p">,</span> <span class="s1">'wangwu@foxmail.com'</span><span class="p">,</span> <span class="s1">'Guangxi'</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
</code></pre></div></div>

<p>å·²çŸ¥nicknameå­—æ®µä¸Šæœ‰å”¯ä¸€ç´¢å¼•çº¦æŸï¼Œç°åœ¨æ¯æ¡INSERT SQLéƒ½åŠ ä¸Šäº†<code class="language-plaintext highlighter-rouge">IGNORE</code>ï¼Œå¦‚æœç”¨æˆ·æ˜µç§°å·²ç»å­˜åœ¨ï¼Œå°±ä¸æ‰§è¡Œæ’å…¥ï¼›å¦åˆ™æ‰§è¡Œæ’å…¥ã€‚è¿™æ ·å°±ä¸ä¼šå½±å“åç»­çš„INSERT SQLçš„æ‰§è¡Œã€‚</p>

<h3 id="3-ä½¿ç”¨insert-into--on-duplicate-key-update">3. ä½¿ç”¨<code class="language-plaintext highlighter-rouge">INSERT INTO ... ON DUPLICATE KEY UPDATE</code></h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'zhangsan'</span><span class="p">,</span> <span class="s1">'17777778901'</span><span class="p">,</span> <span class="s1">'zhangsan@foxmail.com'</span><span class="p">,</span> <span class="s1">'Beijing'</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span> <span class="k">ON</span> <span class="n">DUPLICATE</span> <span class="k">KEY</span> <span class="k">UPDATE</span> <span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'zhangsan'</span><span class="p">,</span> <span class="s1">'16688990101'</span><span class="p">,</span> <span class="s1">'lisi@foxmail.com'</span><span class="p">,</span> <span class="s1">'Hangzhou'</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span> <span class="k">ON</span> <span class="n">DUPLICATE</span> <span class="k">KEY</span> <span class="k">UPDATE</span> <span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">my_user</span> <span class="p">(</span><span class="n">nickname</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'wangwu'</span><span class="p">,</span> <span class="s1">'155784983939'</span><span class="p">,</span> <span class="s1">'wangwu@foxmail.com'</span><span class="p">,</span> <span class="s1">'Guangxi'</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="k">ON</span> <span class="n">DUPLICATE</span> <span class="k">KEY</span> <span class="k">UPDATE</span> <span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="p">;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">INSERT INTO ... ON DUPLICATE KEY UPDATE</code>ä½œç”¨æ˜¯ï¼Œè‹¥INSERTå‘ç”Ÿäº†å”¯ä¸€æ€§çº¦æŸé”™è¯¯ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œè¯¥æ¡è®°å½•çš„æ›´æ–°æ“ä½œï¼›è‹¥æ²¡æœ‰å‘ç”Ÿå”¯ä¸€æ€§çº¦æŸé”™è¯¯ï¼Œè¯´æ˜è®°å½•è¿˜æœªå­˜åœ¨ï¼Œç›´æ¥æ‰§è¡Œæ’å…¥æ“ä½œã€‚</p>

<hr />


        </div>
      </div>
    </div>
  </body>
  <div class="footer">
  <p>Copyright Â© 2021-2023&nbsp;|&nbsp;Powered by <a href="http://jekyllcn.com" target="_blank">Jekyll</a>. Theme by <a href="https://github.com/loji44/ExSimple" target="_blank">ExSimple</a>.</p>
</div>
</html>